<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>uTrack: uTrack/utUSB.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">uTrack
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a4e24aea86a0dbe5a7267615eff7c74c.html">uTrack</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">utUSB.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Support for treating the Yachbot as a USB device of some kind, currently only mass storage (MSC).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;uTrack.h&quot;</code><br />
<code>#include &quot;utHAL.h&quot;</code><br />
<code>#include &quot;utUSB.h&quot;</code><br />
<code>#include &quot;File_Config.h&quot;</code><br />
<code>#include &quot;LPC23xx.h&quot;</code><br />
<code>#include &lt;rl_usb.h&gt;</code><br />
<code>#include &quot;usb_lib.c&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:adeed8f500b8d9ad55c25123ae639e9ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ut_u_s_b_8c.html#adeed8f500b8d9ad55c25123ae639e9ce">TIME_BETWEEN_PRINTS</a>&#160;&#160;&#160;2000</td></tr>
<tr class="separator:adeed8f500b8d9ad55c25123ae639e9ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a11c30ccca2865f108b695ab7d39b5d15"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ut_u_s_b_8c.html#a11c30ccca2865f108b695ab7d39b5d15">utUSB_Notify</a> (UT_DeviceMessage state)</td></tr>
<tr class="separator:a11c30ccca2865f108b695ab7d39b5d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49e9fb163ac79afb5ffa43ac205bde88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ut_u_s_b_8c.html#a49e9fb163ac79afb5ffa43ac205bde88">utUSB_Setup</a> (void)</td></tr>
<tr class="separator:a49e9fb163ac79afb5ffa43ac205bde88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62cf7f7d477b7fafd5a179ae886d1b01"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ut_u_s_b_8c.html#a62cf7f7d477b7fafd5a179ae886d1b01">utUSB_Connect</a> (void)</td></tr>
<tr class="separator:a62cf7f7d477b7fafd5a179ae886d1b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b4fe0ce1bb909f6e6e26ba10f33b035"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ut_u_s_b_8c.html#a8b4fe0ce1bb909f6e6e26ba10f33b035">utUSB_Disconnect</a> (void)</td></tr>
<tr class="separator:a8b4fe0ce1bb909f6e6e26ba10f33b035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d09d10f1e411f20f7e20cf7c512e0a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ut_u_s_b_8c.html#a4d09d10f1e411f20f7e20cf7c512e0a0">utUSB_RequestMountNextConnection</a> (bool request)</td></tr>
<tr class="separator:a4d09d10f1e411f20f7e20cf7c512e0a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb2c5625633957bca22ea7cc3822294"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ut_u_s_b_8c.html#a7cb2c5625633957bca22ea7cc3822294">utUSB_IsPluggedIn</a> (void)</td></tr>
<tr class="separator:a7cb2c5625633957bca22ea7cc3822294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a5de3742473122e72aaadabbd9f2d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ut_u_s_b_8c.html#a00a5de3742473122e72aaadabbd9f2d9">utUSB_UserEjected</a> (void)</td></tr>
<tr class="separator:a00a5de3742473122e72aaadabbd9f2d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7b60292c980048b96a447c43589fa47"><td class="memItemLeft" align="right" valign="top"><a id="aa7b60292c980048b96a447c43589fa47" name="aa7b60292c980048b96a447c43589fa47"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>utUSB_StackShouldBeUp</b> (void)</td></tr>
<tr class="separator:aa7b60292c980048b96a447c43589fa47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a995771afeed2d4c353a77b6e263bc6fd"><td class="memItemLeft" align="right" valign="top"><a id="a995771afeed2d4c353a77b6e263bc6fd" name="a995771afeed2d4c353a77b6e263bc6fd"></a>
FAT_VI *&#160;</td><td class="memItemRight" valign="bottom"><b>mc0</b></td></tr>
<tr class="separator:a995771afeed2d4c353a77b6e263bc6fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6251562ef43ceca481f6d98eee8a5a1"><td class="memItemLeft" align="right" valign="top"><a id="ab6251562ef43ceca481f6d98eee8a5a1" name="ab6251562ef43ceca481f6d98eee8a5a1"></a>
Media_INFO&#160;</td><td class="memItemRight" valign="bottom"><b>info</b></td></tr>
<tr class="separator:ab6251562ef43ceca481f6d98eee8a5a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Support for treating the Yachbot as a USB device of some kind, currently only mass storage (MSC). </p>
<p>This software module can be configured to mount the SD card over USB provided the file system has been unmounted or disabled, and can also control charge via USB (specifically the current drawn by the charge chip).</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd><p class="startdd">Device classes other than MSC </p>
<p class="enddd">Non-specialised runtime support.</p>
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Oscar Key </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16/05/2013 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2013, Igtimi Ltd., all rights reserved. </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="adeed8f500b8d9ad55c25123ae639e9ce" name="adeed8f500b8d9ad55c25123ae639e9ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeed8f500b8d9ad55c25123ae639e9ce">&#9670;&#160;</a></span>TIME_BETWEEN_PRINTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_BETWEEN_PRINTS&#160;&#160;&#160;2000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks to see if the USB module expects the stack to be up.</p>
<dl class="section return"><dt>Returns</dt><dd>True if the USB stack should be up according to module info. </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a62cf7f7d477b7fafd5a179ae886d1b01" name="a62cf7f7d477b7fafd5a179ae886d1b01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62cf7f7d477b7fafd5a179ae886d1b01">&#9670;&#160;</a></span>utUSB_Connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void utUSB_Connect </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempt to launch the USB stack in MSC mode. Setting up the memory card can fail. If configured to do so, the USB will also request more current from the charge chip so that the unit charges properly. </p>

</div>
</div>
<a id="a8b4fe0ce1bb909f6e6e26ba10f33b035" name="a8b4fe0ce1bb909f6e6e26ba10f33b035"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b4fe0ce1bb909f6e6e26ba10f33b035">&#9670;&#160;</a></span>utUSB_Disconnect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void utUSB_Disconnect </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Disconnect the USB stack. </p>

</div>
</div>
<a id="a7cb2c5625633957bca22ea7cc3822294" name="a7cb2c5625633957bca22ea7cc3822294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cb2c5625633957bca22ea7cc3822294">&#9670;&#160;</a></span>utUSB_IsPluggedIn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool utUSB_IsPluggedIn </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the USB is plugged in, using the VBUS line, which should be high iff there is a powered entity on the other end.</p>
<dl class="section return"><dt>Returns</dt><dd>True if the unit is plugged into to something via USB. </dd></dl>

</div>
</div>
<a id="a11c30ccca2865f108b695ab7d39b5d15" name="a11c30ccca2865f108b695ab7d39b5d15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c30ccca2865f108b695ab7d39b5d15">&#9670;&#160;</a></span>utUSB_Notify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool utUSB_Notify </td>
          <td>(</td>
          <td class="paramtype">UT_DeviceMessage&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The Notify function passes a message to the software module, informing it of expected module <em>state</em>. It returns a value that is considered a response to a query about the specified <em>state</em>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>A state message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether or not this software module is in the desired <em>state</em>. </dd></dl>

</div>
</div>
<a id="a4d09d10f1e411f20f7e20cf7c512e0a0" name="a4d09d10f1e411f20f7e20cf7c512e0a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d09d10f1e411f20f7e20cf7c512e0a0">&#9670;&#160;</a></span>utUSB_RequestMountNextConnection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void utUSB_RequestMountNextConnection </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Request that the USB stack attempt to mount the file system the next time it is plugged in within this power cycle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">request</td><td>Whether to mount or not. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a49e9fb163ac79afb5ffa43ac205bde88" name="a49e9fb163ac79afb5ffa43ac205bde88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49e9fb163ac79afb5ffa43ac205bde88">&#9670;&#160;</a></span>utUSB_Setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void utUSB_Setup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Do the necessary configuration required before running the USB stack. </p>

</div>
</div>
<a id="a00a5de3742473122e72aaadabbd9f2d9" name="a00a5de3742473122e72aaadabbd9f2d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00a5de3742473122e72aaadabbd9f2d9">&#9670;&#160;</a></span>utUSB_UserEjected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void utUSB_UserEjected </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tells the USB module that the user wants to remove the device. This sets a timer to forcibly drop the USB connection if the correct command sequence for doing so has not been processed (or has failed). </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 26 2024 13:37:23 for uTrack by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
